\include{header}


\begin{document}

\section*{Content of this note}

This notes gives the moments of an Integrated Ornstein Uhlenbeck process. 
Detailled derivations are given.

\section*{Notations}
In the following:
\begin{itemize}
\item $I$ is the identity matrix whose dimension should be explicit in the concerned expression.
\item $\otimes$ is the Kronecker product;
\item For squate matrices $A$ and $B$, $A \oplus B = A\otimes I + I \otimes B$ is the Kronecker sum;
\item For a matrix $A$, $\Vect A$ is the stack operator, i.e. the vectorization of $A$ by stacking its columns.
\end{itemize}

\section{Definition of the Integral Ornstein Uhlenbeck}
We consider here a stochastic process $\left\lbrace V_t, X_t \right\rbrace_{t \geq 0}$ taking values in $\mathbb{R}^{d}\times \mathbb{R}^{d}$ (typically, $d = 2$ in movement ecology), following an integrated Ornstein Uhlenbeck process.
Formally, $\left\lbrace V_t, \right\rbrace_{t \geq 0}$ is supposed to be the solution of a linear stochastic differential equation, and $\left\lbrace V_t, \right\rbrace_{t \geq 0}$ is its integration over time.
This can be write in the following way: 
\begin{align}
\rmd V_t &= -\Gamma \left( V_t - \mu \right)\rmd t + \Sigma \rmd W_t,~~V_0 = v_0\label{eq:OU:append}\\
X_t &= x_0 + \int_0^t V_s \rmd s\label{eq:IOU:append}
\end{align}
where $\mu$ is vector of $\mathbb{R}^d$, $\Gamma$ is a $d \times d$ invertible matrix, and $\Sigma$ is a $d \times d$ matrix such that $\Sigma\Sigma^T$ is symmetric and positive definite.

This process is a Gaussian Markov process, such that for a positive time $t$.
$$\begin{pmatrix}
V_{t}\\
X_{t}
\end{pmatrix} \vert \begin{pmatrix}
V_{0} = v_0 \\
X_{0} = x_0
\end{pmatrix} \sim \mathcal{N}_{2d}\left( \begin{pmatrix}
m^V_{t}\\
m^X_{t}
\end{pmatrix}, \begin{pmatrix}
\Sigma^{X, V}(t) = \begin{pmatrix}
C^{V}(t) & \left(C^{X, V}(t)\right)^T\\
C^{X, V}(t) & C^{X}(t)
\end{pmatrix}
\end{pmatrix} \right)$$

\section{Moments of Integrated Ornstein Uhlenbeck process}
We have the following results:
\begin{align}
m^V(t) &= \mu + \e^{-\Gamma t} ( v_0 - \mu)\label{eq:mean:OU}\\
m^X(t) &= x_0 + I\mu t - \Gamma\inv\e^{-\Gamma t} ( v_0 - \mu)\label{eq:mean:IOU}\\
 C^V(t) &= \Sinf\e^{-\Gamma^T (t - s)} -\e^{-\Gamma s}\Sinf \e^{-\Gamma^T t} \label{eq:var:OU}\\
 C^{X,V}(t) &= \Sinf \Gamma^{-T}\left(I - \e^{-\Gamma^T t}\right) + \Gamma\inv\left(\e^{-\Gamma t} - I\right)\Sinf  \e^{-\Gamma^T t} \label{eq:cov:IOU:OU}\\
 C^X(t) &= \M t - \left(I - \e^{-\Gamma^T t}\right)\Gamma\inv \M - \M\Gamma^{-T}\left(I - \e^{-\Gamma^T t}\right)+ \Gamma\inv \Sinf \Gamma^{-T} - 
   \e^{-\Gamma t}\Gamma\inv\Sinf\Gamma^{-T}\e^{-\Gamma^T t}, \label{eq:var:IOU}
\end{align}
where $\Sinf$ is the matrix such that:
 \begin{equation}
\Vect{\Sinf} = \GpG\inv\Vect{\Sigma \Sigma^T}, \label{eq:matrix:S}
\end{equation}
and $\M$ is the matrix:
 \begin{equation}
\M= \Sinf\Gamma^{-T} + \Gamma\inv\Sinf, \label{eq:matrix:M}
\end{equation}
Moreover, the computations give the time covariance structures:
\begin{align}
C^V(s, t) &=  \left\lbrace \begin{array}{lr}
 \Sinf\e^{-\Gamma^T (t - s)} -\e^{-\Gamma s}\Sinf \e^{-\Gamma^T t},& ~\text{ if } s \leq t \\
 \e^{-\Gamma (s - t)}\Sinf -\e^{-\Gamma s}\Sinf \e^{-\Gamma^T t},&~\text{ if } s \geq t
\end{array}\right.
\label{eq:time:cov:OU}\\
C^X(s, t) = &\M s - \left(I - \e^{-\Gamma^T s}\right)\Gamma\inv \M - \M\Gamma^{-T}\left(e^{-\Gamma^T (t-s)} - \e^{-\Gamma^T t}\right)+
   \e^{-\Gamma t}\Gamma\inv\Sinf\Gamma^{-T}\e^{-\Gamma^T t} \nonumber \\
   &+ \Gamma\inv\Sinf\Gamma^{-T}\e^{\Gamma^T(t - s)} \label{eq:time:cov:IOU}
\end{align}
 All these equations are proven below.
\section{Derivations}
\subsection{Means}
If $(V_t, X_t)_{t\geq 0}$ satisfy \eqref{eq:OU:append} and \eqref{eq:IOU:append}, it is known that:
$$V_t = \mu + \e^{-\Gamma t}(v_0 - \mu) + \int^t_0 \e^{\Gamma (u-t)}\Sigma \rmd W_u$$
Therefore \eqref{eq:mean:OU} and \eqref{eq:mean:IOU} are easily found:
\begin{align*}
m^V(t) &= \mu + \e^{-\Gamma t}(v_0 - \mu)\\
m^X(t) &= x_0 + \int_0^tm^V(u)\rmd u\\
&= x_0 + I\mu t - \Gamma\inv \e^{-\Gamma t}( v_0 - \mu)
\end{align*}
\subsection{Covariances}
\subsubsection{$C^V(t)$}
Let's first compute $C^V(s, t)$. By definition:
\begin{align*}
\Cov[V_s, V_t] &= \mathbb{E}\left[ \left(V_s - \mathbb{E}[V_s]\right)\left(V_t - \mathbb{E}[V_t]\right)^T\right]\\
&= \mathbb{E}\left[  \int^s_0 \e^{\Gamma (u-s)}\Sigma \rmd W_u  \int^t_0 \Sigma^T \e^{\Gamma^T (u-t)}\rmd W^T_u \right]
\intertext{Therefore, using Ito Isometry}
C(s,t)^V = \Cov[V_s, V_t] &= \int_0^{\min(s, t)} \e^{\Gamma (u-s)} \Sigma\Sigma^T \e^{\Gamma^T (u-t)} \rmd u
\end{align*}
We now need the following properties:
\begin{align}
\Vect{\int A_u\rmd u} &= \int \Vect {A_u} \rmd u \label{eq:vec:integral}\\
\Vect{ABC} &= (C^T \otimes A) \Vect {B} \label{eq:vec:product}\\
(\e^A)^T &= \e^{A^T} \label{eq:expm:transpose}\\
\e^A \otimes \e^B &= \e^{A\oplus B} \label{eq:expm:kron:sum}\\
\frac{\rmd}{\rmd t} \e^{At} &= A \e^{At} =  \e^{At}A. \label{eq:expm:derivative}
\end{align}


We can now compute the wanted covariance, as:
\begin{align*}
\Vect{C^V(s,t)} &= \Vect{\int_0^{\min(s, t)} \e^{\Gamma (u-s)} \Sigma\Sigma^T \e^{\Gamma^T (u-t)} \rmd u} & \\
&=\int_0^{\min(s, t)} \e^{\Gamma (u-t)} \otimes \e^{\Gamma (u-s)}  \rmd u~ \Vect{\Sigma\Sigma^T}& \text{ by eqs. \eqref{eq:vec:integral}-\eqref{eq:expm:transpose}}\\
&= \int_0^{\min(s, t)} \e^{\Gamma \otimes I (u-t) + I \otimes \Gamma (u -s)}\rmd u~ \Vect{\Sigma\Sigma^T}  & \text{ by \eqref{eq:expm:kron:sum}} \\
&= \left[ \e^{\Gamma \otimes I (u-t) + I \otimes \Gamma (u -s)} \right]_{u=0}^{u = \min(s, t)} \GpG\inv  \Vect{\Sigma \Sigma^T}  & \text{ by \eqref{eq:expm:derivative}}  \\
&= \left\lbrace \begin{array}{lr}
 \left( \e^{- \Gamma \otimes I (t - s)} - \e^{-(\Gamma t \oplus \Gamma s)} \right) \GpG\inv \Vect{\Sigma \Sigma^T} & s \leq t \\
 \left(\e^{- I \otimes \Gamma (s - t)} - \e^{-(\Gamma t \oplus \Gamma s)} \right) \GpG\inv \Vect{\Sigma \Sigma^T} & s \geq t
\end{array}\right. &
\end{align*}


The above equation boils down to,  when $s=t$ :
$$\left(I - \e^{-(\Gamma  \oplus \Gamma) t} \right) \GpG\inv\Vect{\Sigma \Sigma^T} $$
We now denote $\Sinf$ the matrix such that:
\begin{equation}
\Vect{\Sinf} = \GpG\inv\Vect{\Sigma \Sigma^T} \label{eq:S:matrix}
\end{equation}
which, when $\Gamma$ has positive real part eigenvalues, is the asymptotic variance of the random variable $V_t$.

Therefore, we have, when $s\leq t$,
\begin{align*}
\Vect{\Sigma_{s,t}^V} &= \left( \e^{- \Gamma(t-s) \otimes I } - \e^{-(\Gamma t \oplus \Gamma s)} \right) \Vect{\Sinf}& \\
&=\left( \e^{- \Gamma(t-s) \oplus \mathbf{0}} - \e^{-(\Gamma t \oplus \Gamma s)} \right) \Vect{\Sinf}&\\
&=\left( \e^{- \Gamma(t-s)} \otimes I - \e^{-\Gamma t} \otimes \e^{\Gamma s} \right) \Vect{\Sinf} & \text { by \eqref{eq:expm:kron:sum}}\\
&=\left( \e^{- \Gamma(t-s)} \otimes I\right)\Vect{\Sinf} - \left(\e^{-\Gamma t} \otimes \e^{\Gamma s} \right)\Vect{\Sinf}  & \\
&=\Vect{\Sinf\e^{-\Gamma^T (t - s)}} -\Vect{\e^{-\Gamma s}\Sinf \e^{-\Gamma^T t}} & \text{ by \eqref{eq:vec:product}}\\
\end{align*}
Therefore, by linearity of the $\Vect{\hbox{}}$ operator, and applying the same reasoning when $s\geq t$, we have:
\begin{equation}
\Sigma_{s,t}^V =  \left\lbrace \begin{array}{lr}
 \Sinf\e^{-\Gamma^T (t - s)} -\e^{-\Gamma s}\Sinf \e^{-\Gamma^T t},& ~\text{ if } s \leq t \\
 \e^{-\Gamma (s - t)}\Sinf -\e^{-\Gamma s}\Sinf \e^{-\Gamma^T t},&~\text{ if } s \geq t
\end{array}\right.
\label{eq:OU:cov:matrix}
\end{equation}
where $\Sinf$ is given by \eqref{eq:S:matrix}.

\subsubsection{Covariance in the IOU process}

\paragraph{Covariance between the velocity and the position}

We now aim at computing $\Cov\left[V_t, X_t\right]$.
By definition of $X_t$, by properties of the covariance, and by \eqref{eq:OU:cov:matrix}, we have:
\begin{align*}
C^{X,V}(t) &= \int_0^t  \Cov(V_s, V_t) \rmd s\\
&=\int_0^t \Sinf\e^{-\Gamma^T (t - s)} -\e^{-\Gamma s}\Sinf \e^{-\Gamma^T t}\\
&= \Sinf\left[\Gamma^{-T}\e^{-\Gamma^T (t - s)} \right]_{s = 0}^{s = t} + \left[\Gamma^{-1}\e^{-\Gamma s} \right]_{s = 0}^{s = t} \Sinf  \e^{-\Gamma^T t}\\
&= \Sinf \Gamma^{-T}\left(I - \e^{-\Gamma^T t}\right) + \Gamma\inv\left(\e^{-\Gamma t} - I\right)\Sinf  \e^{-\Gamma^T t}
\end{align*}

\paragraph{Covariance in the position process}

We now aim at computing $\Cov\left[X_s, X_t\right]$.

Let's first notice that
$$C^X(s,t) : =  \Cov(X_s, X_t)  = \int_0^t \left( \int_0^s \Cov(V_u, V_v) \rmd u \right) \rmd v$$
which can be split in (when $s\leq t$)
$$C^X(s,t) = \int_0^s \left( \int_0^v \Cov(V_u, V_v) \rmd u \right) \rmd v + \int_0^s \left( \int_v^s \Cov(V_u, V_v) \rmd u \right) \rmd v + \int_s^t \left( \int_0^s \Cov(V_u, V_v) \rmd u \right) \rmd v$$

Therefore, it remains to use \eqref{eq:OU:cov:matrix} to conclude:

\begin{align*}
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%% Whole Integrals %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
C^X(s,t) =& \int_0^s \left( \int_0^v
  \Sinf\e^{-\Gamma^T (v - u)} -\e^{-\Gamma u}\Sinf \e^{-\Gamma^T v} 
  \rmd u \right) \rmd v \\
  &+ \int_0^s \left( \int_v^s 
  \e^{-\Gamma (u - v)}\Sinf -\e^{-\Gamma u}\Sinf \e^{-\Gamma^T v} 
  \rmd u \right) \rmd v \\
  &+ \int_s^t \left( \int_0^s 
  \Sinf\e^{-\Gamma^T (v - u)} -\e^{-\Gamma u}\Sinf \e^{-\Gamma^T v} 
  \rmd u \right) \rmd v\\
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%% FIRST PRIMITIVES %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  =& \int_0^s \left[ 
  \Sinf\Gamma^{-T}\e^{-\Gamma^T (v - u)} +\Gamma\inv\e^{-\Gamma u}\Sinf \e^{-\Gamma^T v} 
  \right]_{u = 0}^{u = v} 
  \rmd v\\
  &+ \int_0^s \left[
  -\e^{-\Gamma (u - v)}\Gamma\inv\Sinf + \Gamma\inv\e^{-\Gamma u}\Sinf \e^{-\Gamma^T v} 
  \right]^{u = s}_{u = v}
  \rmd v \\
  &+ \int_s^t \left[ 
  \Sinf\Gamma^{-T}\e^{-\Gamma^T (v - u)} +\Gamma\inv\e^{-\Gamma u}\Sinf \e^{-\Gamma^T v} 
  \right]_{u = 0}^{u = s} 
  \rmd v\\
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%% EVAL FIRST PRIMITIVES %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  =& \int_0^s \left\lbrace
  \Sinf \Gamma^{-T}\left(I - \e^{-\Gamma^T v}\right) + \left(\e^{-\Gamma v} - I\right)\Gamma\inv\Sinf  \e^{-\Gamma^T v}
   \right .\\
   &+ \left.
  \left(I - \e^{-\Gamma(s - v)}\right)\Gamma\inv\Sinf + \left( \e^{-\Gamma s} - \e^{-\Gamma v}\right)\Gamma\inv\Sinf \e^{-\Gamma^T v} 
  \right\rbrace \rmd v \\
  &+ \int_s^t 
  \Sinf\Gamma^{-T}\left(\e^{-\Gamma^T (v - s)} - \e^{-\Gamma^T v}\right) +\left(\e^{-\Gamma s} - I\right)\Gamma\inv\Sinf \e^{-\Gamma^T v} 
  \rmd v\\
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%% Simplifications %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  =& \int_0^s \left\lbrace
  \Sinf \Gamma^{-T}\left(I - \e^{-\Gamma^T v}\right) + 
  \left(\e^{-\Gamma s} - I\right)\Gamma\inv\Sinf  \e^{-\Gamma^T v} + 
  \left(I - \e^{-\Gamma(s - v)}\right)\Gamma\inv\Sinf 
  \right\rbrace \rmd v \\
  &+ \int_s^t 
  \Sinf\Gamma^{-T}\left(\e^{-\Gamma^T (v - s)} - \e^{-\Gamma^T v}\right) +\left(\e^{-\Gamma s} - I\right)\Gamma\inv\Sinf \e^{-\Gamma^T v} 
  \rmd v\\
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%% SECOND PRIMITIVES %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
  =& \left[
  \left(\Sinf \Gamma^{-T} + \Gamma\inv\Sinf \right)v +
   \Sinf \Gamma^{-T}\Gamma^{-T}\e^{-\Gamma^T v} - 
  \left(\e^{-\Gamma s} - I\right)\Gamma\inv\Sinf\Gamma^{-T}\e^{-\Gamma^T v} -
  \e^{-\Gamma(s - v)}\Gamma\inv\Gamma\inv\Sinf  
  \right]_{
  v = 0}^{v = s}\\
  &+ \left[ 
  -\Sinf\Gamma^{-T}\Gamma^{-T} \left(\e^{-\Gamma^T (v - s)} - \e^{-\Gamma^T v}\right)-\left(\e^{-\Gamma s} - I\right)\Gamma\inv\Sinf \Gamma^{-T} \e^{-\Gamma^T v}
  \right]_{v = s}^{v = t}\\
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%% FINAL EXPRESSION %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
  =& 
  \left(\Sinf \Gamma^{-T} + \Gamma\inv\Sinf \right)s +
   \Sinf \Gamma^{-T}\Gamma^{-T}\e^{-\Gamma^T s} - 
   \Sinf \Gamma^{-T}\Gamma^{-T} -
   \e^{-\Gamma s}\Gamma\inv\Sinf\Gamma^{-T}\e^{-\Gamma^T s} +
   \e^{-\Gamma s}\Gamma\inv\Sinf\Gamma^{-T} + \\
   &+
   \Gamma\inv\Sinf\Gamma^{-T}\e^{-\Gamma^T s} -
   \Gamma\inv\Sinf\Gamma^{-T} -
   \Gamma\inv\Gamma\inv\Sinf +
    \e^{-\Gamma s}\Gamma\inv\Gamma\inv\Sinf
  \\
  &
  -\Sinf\Gamma^{-T}\Gamma^{-T} 
  \left(
  \e^{-\Gamma^T (t - s)} -
  I - \e^{-\Gamma^T t} + \e^{-\Gamma^T s}\right)
  -\left(\e^{-\Gamma s} - I\right)\Gamma\inv\Sinf\Gamma^{-T} ( \e^{-\Gamma^T t} - \e^{-\Gamma^T s}) 
\end{align*}
By writing 
$$\M = \Sinf\Gamma^{-T} + \Gamma\inv\Sinf$$, we obtain the two following equivalent formulations
\begin{align}
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%% Simplification %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 C^X(s,t)  =&\M s - \left(I - \e^{-\Gamma^T s}\right)\Gamma\inv M - M\Gamma^{-T}\left(I - \e^{-\Gamma^T s}\right)+ \Gamma\inv \Sinf \Gamma^{-T} - 
   \e^{-\Gamma t}\Gamma\inv\Sinf\Gamma^{-T}\e^{-\Gamma^T t} \nonumber \\
   &+
   \M\Gamma^{-T}\left(\e^{-\Gamma^T t} - \e^{-\Gamma^T s} \right) 
   + \Sinf\Gamma^{-T}\Gamma^{-T}\left(I - \e^{-\Gamma^T(t -s)} \right) \label{eq:cov:IOU}\\
   = &\M s - \left(I - \e^{-\Gamma^T s}\right)\Gamma\inv \M - \M\Gamma^{-T}\left(e^{-\Gamma^T (t-s)} - \e^{-\Gamma^T t}\right)+
   \e^{-\Gamma t}\Gamma\inv\Sinf\Gamma^{-T}\e^{-\Gamma^T t} \nonumber \\
   &+ \Gamma\inv\Sinf\Gamma^{-T}\e^{\Gamma^T(t - s)} \label{eq:cov:IOU:bis}
\end{align}
The second line of \eqref{eq:cov:IOU} vanishes when $s = t$, and , in this case:
$$C^X(t) = \M t - \left(I - \e^{-\Gamma^T t}\right)\Gamma\inv M - M\Gamma^{-T}\left(I - \e^{-\Gamma^T t}\right)+ \Gamma\inv \Sinf \Gamma^{-T} - 
   \e^{-\Gamma t}\Gamma\inv\Sinf\Gamma^{-T}\e^{-\Gamma^T t}$$

\subsection{Alternative derivations of covariances using the $\Vect{\hbox{}}$ operator}

\begin{align}
\Vect{C^V (t)} &= \GpG\inv \left(I - \e^{-(\Gamma  \oplus \Gamma) t} \right) \Vect{\Sigma \Sigma^T} \label{eq:CX}\\
\Vect{C^X(t)} &= \GpG\inv \times \nonumber\\
&~~\left\lbrace   \left(\Gamma\inv \oplus \Gamma\inv \right)t + \GoI^{-2}\left(\e^{-\GoI t}  - I \right)\right. \nonumber\\
&~~~ + \IoG\inv\GoI\inv\left(\e^{-\GoI t} + \e^{-\IoG t} - \e^{-\GpG t} - I \right)\nonumber \\
&~~~\left. + \IoG^{-2} \left(\e^{-\IoG t}  - I \right)\right\rbrace\Vect{\Sigma\Sigma^T}\label{eq:CV}\\
\Vect{C^{X,V}(t)}&= \GpG\inv\times \nonumber\\ 
&~~ \left\lbrace \GoI\inv + \IoG \e^{- \GpG t} - \right( \GoI\inv + \IoG\inv \left)\e^{-\GoI t}\right\rbrace \Vect{\Sigma\Sigma^T}\label{eq:CVX}
\end{align}

Let's first notice that
$$C^X(s,t) : =  \Cov(X_s, X_t)  = \int_0^t \left( \int_0^s \Cov(V_u, V_v) \rmd u \right) \rmd v$$
which can be split in (when $s\leq t$)
$$C^X(s,t) = \int_0^s \left( \int_0^v \Cov(V_u, V_v) \rmd u \right) \rmd v + \int_0^s \left( \int_v^s \Cov(V_u, V_v) \rmd u \right) \rmd v + \int_s^t \left( \int_0^s \Cov(V_u, V_v) \rmd u \right) \rmd v$$
\begin{align*}
\Vect{C^X(s,t)}  =& \GpG\inv \times\\
&\left\lbrace   \int_0^s \left(\int_0^v  \e^{- \Gamma \otimes I (v - u)} - \e^{-(\Gamma v \oplus \Gamma u)} \rmd u \right) \rmd v \right. \\
& +  \int_0^s \left(\int_v^s  \e^{- I \otimes \Gamma (u - v)} - \e^{-(\Gamma v \oplus \Gamma u)} \rmd u \right) \rmd v\nonumber \\
&+ \left. \int_s^t \left(\int_0^s  \e^{- \Gamma \otimes I (v - u)} - \e^{-(\Gamma v \oplus \Gamma u)} \rmd u \right) \rmd v \right\rbrace \Vect{\Sigma\Sigma^T}\nonumber\\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
=& \GpG\inv \times\\
&\left\lbrace   \int_0^s \left[  \GoI\inv \e^{- \Gamma \otimes I (v - u)} + \IoG\inv \e^{-(\Gamma v \oplus \Gamma u)} \right]_{u=0}^{u = v} \rmd v \right. \\
& +  \int_0^s \left[ - \IoG\inv  \e^{- I \otimes \Gamma (u - v)} + \IoG\inv \e^{-(\Gamma v \oplus \Gamma u)}\right]_{u = v}^{u = s} \rmd v \\
&\left. + \int_s^t \left[  \GoI\inv \e^{- \Gamma \otimes I (v - u)} + \IoG\inv \e^{-(\Gamma v \oplus \Gamma u)} \right]_{u=0}^{u = s} \rmd v \right\rbrace \Vect{\Sigma\Sigma^T}\nonumber
\\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
=& \GpG\inv \times\\
&\left\lbrace   \int_0^s \left(  \GoI\inv + \IoG\inv \e^{-\GpG v} - \left(\GoI\inv + \IoG\inv\right) \e^{-\GoI v} \right) \rmd v \right. \\
&+ \int_0^s \left(  - \IoG\e^{- I \otimes \Gamma (s - v)} + \IoG\inv \e^{-(\Gamma v \oplus \Gamma s)} + \IoG \inv - \IoG\inv \e^{-\GpG v} \right) \rmd v\nonumber\\
&\left. + \int_s^t \left(  \GoI\inv \e^{- \Gamma \otimes I (v - s)} + \IoG\inv \e^{-(\Gamma v \oplus \Gamma s)} - \left(\GoI\inv + \IoG\inv\right) \e^{-\GoI v} \right) \rmd v \right\rbrace\nonumber\\
&\times  \Vect{\Sigma\Sigma^T}\nonumber\\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
=& \GpG\inv \times\\
&\left\lbrace   \int_0^s \left(  \GoI\inv + \IoG\inv  + \IoG\inv \e^{-(\Gamma v \oplus \Gamma s)} \right. \right.\nonumber\\
&\left.\hspace{1cm} - \left(\GoI\inv + \IoG\inv\right) \e^{-\GoI v} - \IoG\e^{- I \otimes \Gamma (s - v)} \right)\rmd v \\
&\left. + \int_s^t \left(  \GoI\inv \e^{- \Gamma \otimes I (v - s)} + \IoG\inv \e^{-(\Gamma v \oplus \Gamma s)} - \left(\GoI\inv + \IoG\inv\right) \e^{-\GoI v} \right) \rmd v \right\rbrace\nonumber\\
&\times  \Vect{\Sigma\Sigma^T}\nonumber\\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
=& \GpG\inv \times\\
&\left\lbrace   \left[  \left(\GoI\inv + \IoG\inv\right)v  - \IoG\inv \GoI\inv \e^{-(\Gamma v \oplus \Gamma s)} \right. \right.\nonumber\\
&\left.\hspace{1cm} + \left(\GoI\inv + \IoG\inv\right)\GoI\inv \e^{-\GoI v} - \IoG^{-2}\e^{- I \otimes \Gamma (s - v)} \right]_{v=0}^{v=s}\nonumber\\
& + \left[\left(\GoI\inv + \IoG\inv\right)\GoI\inv \e^{-\GoI v} - \GoI^{-2}\e^{- \Gamma \otimes I (v - s)}\right.\nonumber \\
&\left. \left.\hspace{1cm}- \IoG\inv\GoI\inv \e^{-(\Gamma v \oplus \Gamma s)} \right]_{v=s}^{v=t}\right\rbrace \Vect{\Sigma\Sigma^T}\nonumber
\\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
=& \GpG\inv \times\\
&\left\lbrace   \left(\GoI\inv + \IoG\inv\right)s - \IoG\inv \GoI\inv \e^{-\GpG s}\right.\nonumber\\
& + \left(\GoI\inv + \IoG\inv\right)\GoI\inv \e^{-\GoI s} - \IoG^{-2}  \\
& + \IoG\inv \GoI\inv \e^{-\IoG s} - \left(\GoI\inv + \IoG\inv\right)\GoI\inv + \IoG^{-2}\e^{-\IoG s}\nonumber 
\\
& + \left(\left(\GoI\inv + \IoG\inv\right)\GoI\inv \e^{-\GoI t} - \GoI^{-2}\e^{- \Gamma \otimes I (t - s)} - \IoG\inv\GoI\inv \e^{-(\Gamma t \oplus \Gamma s)}\right.\nonumber \\
&\left. \left.\hspace{0.5cm} - \left(\GoI\inv + \IoG\inv\right)\GoI\inv \e^{-\GoI s} + \GoI^{-2}  +\IoG\inv\GoI\inv \e^{-\GpG s)}  \right)\right\rbrace\nonumber\\
&\times  \Vect{\Sigma\Sigma^T}\nonumber
\end{align*}
From the expression above, we deduce equation \eqref{eq:CX} by setting $s = t$.

Finally, for \eqref{eq:CVX}, we consider $C^{V,X}(t)$, namely, $\Cov (V_t, X_t)$
\begin{align*}
\Vect{C^{V,X}(t)} =& \Vect{\int_0^t  \Cov(V_t, V_u) \rmd u}\\
=&\GpG\inv  \left\lbrace\int_0^t  \e^{-\GoI(t-u)} - \e^{-\left(\Gamma t \oplus \Gamma u \right)}\rmd u \right\rbrace \Vect{\Sigma\Sigma^T}\\
=& \GpG\inv  \left[\GoI\inv \e^{-\GoI(t-u)} + \IoG\inv \e^{-\left(\Gamma t \oplus \Gamma u \right)} \right]_{u=0}^{u=t} \Vect{\Sigma\Sigma^T} \\
=& \GpG\inv  \left\lbrace \GoI\inv + \IoG\inv \e^{- \GpG t} - \right( \GoI\inv + \IoG\inv \left)\e^{-\GoI t}\right\rbrace \Vect{\Sigma\Sigma^T}
\end{align*}

\end{document}